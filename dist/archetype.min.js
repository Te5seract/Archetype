(()=>{"use strict";window.Archetype=class{constructor(t){this.callback=t,this.useGlobal=[],this.callback&&this.callback()}_getMethodTypes(t){return{loud:[],decorators:[],quiet:[],sort:function(){return t.filter((t=>{t.match(/\$([a-zA-Z]|\d+)/)?this.loud.push(t):t.match(/__.*?/)?this.decorators.push(t):this.quiet.push(t)})),delete this.sort,this}}.sort()}_callMethods(t,e){const{loud:o,decorators:r}=e;o.forEach((e=>{const o={};this._pushDecorator(o,t,e,r),t[e](o)}))}_pushDecorator(t,e,o,r){o=o.replace(/\$/,""),r.forEach((o=>{const r=this._decoratorName(o),s=void 0!==e[o]();t[r]=s?e[o]():e[o]}))}_decoratorName(t){const e=t.replace(/__/,"").split("_");return e.forEach(((t,o)=>{if(o>0){const r=t.split(""),s=r.splice(0,1);e[o]=s[0].toUpperCase()+r.join("")}})),e.join("")}_routeParams(t){if(!t.match(/{.*?}/g))return t;const e=window.location.pathname,o=e.split("/"),r=t.match(/{.*?}/g),s=t.split("/"),c={route:t,path:e,params:{}};return r.forEach((t=>{const e=s.indexOf(t),r=t.replace(/{|}/g,"");s[e]=o[e],c.params[r]=o[e]})),c.routeProcessed=s.join("/"),c.match=e===s.join("/"),c}_makeProps(t,e){this[t]=e}_setProps(t,...e){if(this[t]){let o=this[t];for(let t=0;t<e.length;t++)if(o[e[t]])o=o[e[t]];else{if(t+1===e.length-1){o[e[t]]=e[t+1];break}o=o[e[t]]={}}}}_getProps(t,...e){if(!e.length)return this[t];let o=this[t];return e.forEach((e=>{o[e]?o=o[e]:console.warn(`_getProps error: ${e} in ${t} was not found.`)})),o}_use(t,e){Object.getOwnPropertyNames(t.prototype).join(",");const o=this._getMethod(t,"use_","uses_"),r=e.use,s={};if(!o)return;if(!r)return;this.useGlobal.length&&this.useGlobal.forEach((t=>{r.push(t)})),r.forEach((t=>{for(let e in t)s[e]=t[e]}));const c=t.prototype[o](s);c&&c.forEach((e=>{if(e.prototype){Object.getOwnPropertyNames(e.prototype).forEach((o=>{t.prototype[o]=e.prototype[o]}))}else e.methods&&e.scope&&e.methods.forEach((o=>{t.prototype[o]=e.scope.prototype[o]}))}))}_getMethod(t,...e){const o=Object.getOwnPropertyNames(t.prototype).join(","),r=e.join("|"),s=new RegExp(r,"gi"),c=o.match(s);return!!c&&c[0]}load(t){return t.forEach((t=>{const e=Object.getOwnPropertyNames(t instanceof Function?t.prototype:t.scope.prototype),o=t instanceof Function?t:t.scope;if(-1!==e.indexOf("route_")){const e=this._routeParams(o.prototype.route_());if(e.match){this._makeProps("instance_proto",o.prototype),this._setProps("instance_proto","route",e),this._use(o,t);const r=new o,s=this._getMethodTypes(Object.getOwnPropertyNames(Object.getPrototypeOf(r)));this._callMethods(r,s)}}})),this}use(t){if(t.length)return this.useGlobal=t,this}}})();