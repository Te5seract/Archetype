(()=>{"use strict";window.Archetype=class{constructor(t){this.callback=t,this.useGlobal=[],this.callback&&this.callback()}_getMethodTypes(t){return{loud:[],decorators:[],quiet:[],sort:function(){return t.filter((t=>{t.match(/\$([a-zA-Z]|\d+)/)?this.loud.push(t):t.match(/__.*?/)?this.decorators.push(t):this.quiet.push(t)})),delete this.sort,this}}.sort()}_callMethods(t,e){const{loud:o,decorators:s}=e;o.forEach((e=>{const o={};this._pushDecorator(o,t,e,s),t[e](o)}))}_pushDecorator(t,e,o,s){o=o.replace(/\$/,""),s.forEach((o=>{const s=this._decoratorName(o);t[s]=e[o]}))}_decoratorName(t){const e=t.replace(/__/,"").split("_");return e.forEach(((t,o)=>{if(o>0){const s=t.split(""),r=s.splice(0,1);e[o]=r[0].toUpperCase()+s.join("")}})),e.join("")}_routeParams(t){const e={params:{}};t instanceof Array||(t=[t]);for(let o=0;o<t.length;o++){const s=window.location.pathname,r=s.split("/"),c=t[o].match(/{.*?}/g),n=t[o].split("/");if(t[o].match(/{.*?}/g)){if(c.forEach((t=>{const o=n.indexOf(t),s=t.replace(/{|}/g,"");n[o]=r[o],e.params[s]=r[o]})),s===n.join("/"))return e.match=!0,e.routeProcessed=n.join("/"),e}else{new RegExp(`^${t[o]}$`);if(t[o]===s)return e.match=!0,e}}return e}_makeProps(t,e){this[t]=e}_setProps(t,...e){if(this[t]){let o=this[t];for(let t=0;t<e.length;t++)if(o[e[t]])o=o[e[t]];else{if(t+1===e.length-1){o[e[t]]=e[t+1];break}o=o[e[t]]={}}}}_getProps(t,...e){if(!e.length)return this[t];const o=this[t];let s=this[t];return e.forEach((t=>{s[t]?s=s[t]:console.error(`_getProps error: ${t.join(" > ")} in "${o.constructor.name}" was not found: ${o.constructor.name}`,o)})),s}_use(t,e){Object.getOwnPropertyNames(t.prototype).join(",");const o=this._getMethod(t,"use_","uses_"),s=this.useGlobal,r={};if(e instanceof Function&&!(e={scope:e}).use&&s.length&&(e.use=s),e.use||(e.use=[]),!o)return;this.useGlobal.length&&this.useGlobal.forEach((t=>{e.use.push(t)})),e.use.forEach((t=>{for(let e in t)r[e]=t[e]}));const c=t.prototype[o](r);c&&c.forEach((e=>{if(e.prototype){Object.getOwnPropertyNames(e.prototype).forEach((o=>{t.prototype[o]=e.prototype[o]}))}else e.methods&&e.scope&&e.methods.forEach((o=>{t.prototype[o]=e.scope.prototype[o]}))}))}_getMethod(t,...e){const o=Object.getOwnPropertyNames(t.prototype).join(","),s=e.join("|"),r=new RegExp(s,"gi"),c=o.match(r);return!!c&&c[0]}_setAccessors(t){this._setProps("instance_proto","get",((...t)=>this._getProps("instance_proto",...t)))}load(t){return t.forEach((t=>{const e=Object.getOwnPropertyNames(t instanceof Function?t.prototype:t.scope.prototype),o=t instanceof Function?t:t.scope;if(-1!==e.indexOf("route_")){const e=this._routeParams(o.prototype.route_());if(e.match){this._makeProps("instance_proto",o.prototype),this._setProps("instance_proto","route",e),this._use(o,t),this._setAccessors(o);const s=new o,r=this._getMethodTypes(Object.getOwnPropertyNames(Object.getPrototypeOf(s)));this._callMethods(s,r)}}})),this}instantiate(t){t.forEach((t=>{const e=new t,o=this._getMethodTypes(Object.getOwnPropertyNames(Object.getPrototypeOf(e)));this._callMethods(e,o)}))}use(t){if(t.length)return this.useGlobal=t,this}}})();